#! /usr/bin/env ruby

lib_path = File.expand_path('../../lib', __FILE__)
$LOAD_PATH.unshift(lib_path) unless $LOAD_PATH.include?(lib_path)

require 'automux'

args = ARGV.take_while { |argument| argument.match(/^\w/) }

case args[0]
when 'setup'
  Automux::Controller::Setup.new.clone_defaults
when 'blueprint'
  params = { name: args[2], clone_name: args[3] }
  Automux::Controller::Blueprints.new(params).send(args[1])
else
  params = {
    blueprint_name: args[0] || 'default',
    recipe_name:    args[1] || 'default'
  }
  Automux::Controller::Recipes.new(params).automate
end
